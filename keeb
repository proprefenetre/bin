#!/usr/bin/env bash

variant=$(setxkbmap -query | rg "variant:\s+(\w+)" -r '$1')

intl () {
    setxkbmap -model pc104 \
              -layout us \
              -option \
              -option terminate:ctrl_alt_bksp \
              -option ctrl:nocaps
    notify-send -a "keyboard" "alt-intl"
}

dvorak-alt-intl () {
    setxkbmap -model pc104 \
              -layout us \
              -variant dvorak-alt-intl \
              -option \
              -option terminate:ctrl_alt_bksp \
              -option ctrl:nocaps
    notify-send -a "keyboard" "dvorak-alt-intl"
}

case $1 in
    -q | --qwerty)
        intl
        ;;

    -d | --dvorak)
        dvorak-alt-intl
        ;;

    -t | --toggle)
        if [[ "$variant" ]]; then
            intl
        else
            dvorak-alt-intl
        fi
        ;;

    -p | --print)
        setxkbmap -query
        ;;
esac
